@model Jingl.General.Model.Admin.UserManagement.UserModel
@{
    //ViewData["Title"] = "Signup";
    Layout = "~/Views/Shared/_Temp_Layout.cshtml";
}
<div class="box-white">
    <!-- button back -->
    <div class="back-btn">
        <a asp-controller="Account" asp-action="OnBoarding">
            <img class="icon-menu mt-3 ml-3" src="~/template/img/ic-back-active.png" alt="" />
        </a>
    </div>
    <!-- begin login -->
    <div class="col-12 text-center">
        <h5 class="register-header mt30">
            Sign Up!
        </h5>
    </div>

    <div class="register-content mt30 panel-body panel-form form-signup">
        <form class="form-horizontal form-bordered " id="Frm_SignUp">
            <div class="form-group row">
                <div class="col-lg-12 col-md-12">
                    <label class="form-check-label m-b-5" for="SignUpType">Nama</label>
                    <input type="hidden" name="" id="SignUpType" class="form-control" value="@Model.SignUpType" required />
                    <input type="text" name="" id="FirstName" class="form-control" value="@Model.FirstName" placeholder="Nama" required />
                </div>
            </div>
            @*<div class="form-group row">
            <div class="col-lg-12 col-md-12">
                <label class="form-check-label m-b-5" for="LastName">Name Belakang</label>
                <input type="text" name="" id="LastName" class="form-control" value="@Model.LastName" placeholder="Name Belakang" required />
            </div>
        </div>*@
            <div class="form-group row">
                <div class="col-lg-12 col-md-12">
                    <label class="form-check-label m-b-5" for="UserName">Username</label>
                    <input onchange="checkAvailUsernameability()" type="text" name="" id="UserName" class="form-control" placeholder="Username" required autocomplete="new-username" />
                    <input type="hidden" name="name" id="isValidUsername" />
                    <span id="message"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-lg-12 col-md-12">
                    <label class="form-check-label m-b-5" for="Email">Email</label>
                    <input onchange="checkAvailEmailability()" type="text" name="" id="Email" value="@Model.Email" class="form-control" placeholder="Email" required />
                    <input type="hidden" name="name" id="isValidEmail" />
                    <span id="messageEmail"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-lg-12 col-md-12">
                    <label class="form-check-label m-b-5" for="Password">Password</label>
                    <input type="password" name="" id="Password" class="form-control" placeholder="Password" required autocomplete="new-password" value="@Model.Password"/>

                </div>
            </div>

            @*<div class="form-group row">
        <div class="col-lg-12 col-md-12">
            <label class="form-check-label m-b-5" for="Country">Negara</label>

                 @Html.DropDownListFor(model => model.Country, ViewBag.ListCountry as IEnumerable<SelectListItem>, "Pilih Negara Asal", new { Class = "form-control", Placeholder = "", required = "true" })
             </div>
        </div>*@

            @*
        <div class="form-group row">
            <div class="col-lg-12 col-md-12">
                <label class="form-check-label m-b-5" for="Region">Daerah Asal</label>

                    <label>Region</label>
                    @Html.DropDownListFor(model => model.Region, ViewBag.ListRegion as IEnumerable<SelectListItem>, "Pilih Daerah Asal", new { Class = "form-control", Placeholder = "", required = "true" })

        </div>
                </div>*@
            @*
        <div class="form-group row">
            <div class="col-lg-12 col-md-12">

                <label class="form-check-label m-b-5" for="BirthDate">Tanggal Lahir</label>
                <input type="date" class="form-control selectpicker datepicker" id="BirthDate" placeholder="Select Date" value="04/1/2014" required />
            </div>
        </div>*@
            @*<div class="form-group row">
            <div class="col-12">
                <div id="datepickers">
                    <div class="input-group date" data-provide="datepicker">
                        <label class="form-check-label m-b-5" for="BirthDate">Tanggal Lahir</label>
                        <input type="text" class="form-control" id="BirthDate" placeholder="Select Date" required>
                    </div>
                </div>

            </div>
        </div>*@
            @*
        <div class="form-group row">
            <div class="col-lg-12 col-md-12">
                <label class="form-check-label m-b-5" for="Gender">Jenis Kelamin</label>
                <select class="form-control  selectpicker" data-size="10" data-live-search="true" data-style="btn-white" id="Gender" required>
                    <option value="" selected>Jenis Kelamin</option>
                    <option value="M">Laki - Laki</option>
                    <option value="F">Perempuan</option>
                </select>

            </div>
        </div>*@
            @*
        <div class="form-group row">
            <div class="col-lg-12 col-md-12">
                <label class="form-check-label m-b-5" for="PhoneNumber">Nomor Telepon</label>
                <input type="text" name="" id="PhoneNumber" class="form-control" placeholder="Nomor Telepon" value="@Model.PhoneNumber" required />

            </div>
        </div>*@
            @*<div id="datepicker" class="input-group date" data-date-format="mm-dd-yyyy">
            <input class="form-control" type="text" readonly />
            <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
        </div>*@
            <div class="col align-self-center ck-box">
                <div class=" checkbox checkbox-css m-b-30 text-center mt50">
                    <div class="checkbox checkbox-css m-b-30">
                        <input type="checkbox" id="agreement_checkbox" value="">
                        <label for="agreement_checkbox" class="regular-clr">
                            Yes , Aku ingin dikirimkan berita terbaru
                        </label>
                    </div>
                </div>
            </div>
            <div class="register-buttons mt40 p-b-25">
                <button type="submit" class="btn btn-primary btn-block  btnprocess">Proses <img src="/template/img/ic-proceed.png" class="ic-process"></button>
            </div>
        </form>

        <div class="loadingSign" style="display: none">
            <img src="~/template/img/loadingpink.gif" alt="Alternate Text" />
        </div>

    </div>

</div>

@section scripts
    {
    <script type="text/javascript">
        $(document).ready(function () {
            if ($("#UserName").val() != '')
            {
                checkAvailUsernameability();
            }
            if ($("#Email").val() != '')
            {
                checkAvailEmailability();
            }
        })
    </script>
    <script type="text/javascript">
        function checkAvailUsernameability() {
            var UserName = $("#UserName").val();
             var url = '@Url.Action("VerifyUserNameUsed", "Account")';
            $.ajax({
                type: "POST",
                url: url,
                data: {
                    UserName: UserName
                },
                success: function (data) {
                    var message = $("#message");
                    if (data == false) {
                        //username available
                        message.css("color", "green");
                        message.html("Username is available");
                        $("#isValidUsername").val(1);
                    } else {
                        //username not available.
                        message.css("color", "red");
                        message.html("Username is NOT available");
                        $("#isValidUsername").val(0);
                    }
                }
            })
        }
        function checkAvailEmailability() {
            var email = $("#Email").val();
         
             var url = '@Url.Action("VerifyEmailUsed", "Account")';
            $.ajax({
                type: "POST",
                url: url,
                data: {
                    email: email
                },
                success: function (data) {
                    var message = $("#messageEmail");
                    if (data == false) {
                        //email available
                        message.css("color", "green");
                        message.html("Email is available");
                        $("#isValidEmail").val(1);
                    } else {
                        //Email not available.
                        message.css("color", "red");
                        message.html("Email is NOT available");
                        $("#isValidEmail").val(0);
                    }
                }
            })
        }
    </script>
    @*<script type="text/javascript">
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                var form = document.getElementById('Frm_SignUp');
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            }, false);
        })();
    </script>*@
    <script type="text/javascript">
      

        $(document).ready(function () {
            
            $('#Frm_SignUp').submit(function (e) {
                e.preventDefault();
                var SignUpType = $("#SignUpType").val();
                var firstName = $("#FirstName").val();
                var lastName = $("#LastName").val();
                var UserName = $("#UserName").val();
                var email = $("#Email").val();
                var password = $("#Password").val();
                var country = $("#Country").val();
                var region = $("#Region").val();
                var birthDate = $("#BirthDate").val();
                var gender = $("#Gender").val();
                var phoneNumber = $("#PhoneNumber").val();
                var isValidUsername = $("#isValidUsername").val();
                var isValidEmail = $("#isValidEmail").val();
                var url = "@Url.Action("SignUpPost", "Account")";
                var jsonRequest = {
                    SignUpType: SignUpType,
                    FirstName: firstName,
                    LastName: lastName,
                    Email: email,
                    Password: password,
                    Country: country,
                    Region: region,
                    BirthDate: birthDate,
                    Gender: gender,
                    PhoneNumber: phoneNumber,
                    UserName: UserName
                };
               
                if (isValidUsername == 1 && isValidEmail == 1)
                {
                    $.ajax({
                    url: url,
                    //cache: false,
                    //traditional: true,
                    type: "POST",
                    data: { model: jsonRequest},
                    //contentType: "application/json; charset=utf-8",
                    //async: false,
                    beforeSend: function () {
                            //$("#spinner").show();
                        $(".loadingSign").show();
                    },
                    complete: function () {
                        $(".loadingSign").hide();
                    },
                    success: function (data) {

                        if (data == "OK") {
                            window.location.href = "@Url.Action("Otp","Account")";
                        }

                        else {

                        }



                    },
                    error: function (jqXHR, textStatus, errorMessage) {
                        console.log(errorMessage);
                    }
                });
                } else {
                    $.gritter.add({
                                title: 'Not Valid !',
                                text: 'Username or Email is not Valid !'
                            });
                }

             


            });
        });
    </script>

}
